pgl-gui                             draft                            2011-01-02


PeerGuardian Linux consists of three components:
- pgld: the IP block daemon itself. It checks internet traffic in the kernel
    user space based on huge blocklists with IP ranges. It then either ACCEPTs,
    DROPs or MARKs the packets.
- pglcmd: does several tasks around pgld:
    - It starts/stops the daemon.
    - It setups the netfilter iptables environment, that decides which traffic
        gets to pgld and what happens with MARKed packets.
    - It handles the blocklists.
    - pglcmd.wd is a watchdog that frequently checks whether the daemon is still
        running and some iptables rules exist. On fail it restarts pglcmd.
- pgl-gui: is the GUI (Graphical User Interface) on top of pgld and pglcmd.


Utilized software:

- C++
- Gtk
- glade
- dbus


Assumptions (check on startup):
- pglcmd's default iptables setup is used
    else offer to change this and "pglcmd restart"
    else start in restricted mode


Design:

Main Window:
- Control Panel:
    - allows to use pglcmd direct commands like start, stop, update, status with
        a single click.
    - shows daemon status (pgld process is running) (red/green light) HOW?
- Log Panel:
    - shows log:
        on startup: show last lines from pgld.log
        gets directly notified by the daemon via dbus about blocked packets and
        other logged events.
    - allows whitelisting: right-click on blocked packets allow to
        - whitelist blocked IP permanently:
            entry to pglcmd's WHITE_IP_FWD, WHITE_IP_IN or WHITE_IP_OUT
            issue iptables command directly
        - whitelist blocked IP+port+protocol combination permanently:
            add iptables command to iptables-gui-insert.sh
            issue iptables command directly
        - whitelist blocked IP's port permanently:
            issue warning that this is a security risk, explain why
            entry to pglcmd's WHITE_[TCP|UDP]_[IN|OUT|FWD]
            issue iptables command directly
        - temporarily whitelist blocked IP, port or IP+port+protocol
          combination:
            issue iptables command directly
- Configure Panel:
    Allows to edit pglcmd's variables. Default values are in pglcmd.defaults.
    Other values are saved in pglcmd.conf.
    Offer to "pglcmd restart" to apply changes for iptables rules or pgld's 
        options.
    "pglcmd reload" to apply changes for blocklists.
    - Main:
        The most important pglcmd variables (automatic start and blocklist
        update, ...)
    - Whitelisting
    - Logging
    - Paths
    - ...
    - pgl-gui specific settings, saved in pgl-gui.conf (/etc/pgl/pgl-gui.conf
        and/or ~/.pgl-gui.conf)

Dockable to system tray
    different icons for whether pgld process is running
    blink on block (make configurable)

Some commands require root privileges. Gain them with gksu/kdesudo.
